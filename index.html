<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css" />
    <title>Wallspace</title>
</head>
<body>
    <div class="main-layout">
        <div class="column-1">
            <div class="control-panel">
                <h3>Wallspace</h3>
                <div class="form-group">
                    <label>Wall Size</label>
                    <div class="wall-size-row">
                        <div class="wall-size-inputs">
                            <div class="dimension-input">
                                <span class="dimension-label">W</span>
                                <input type="number" id="wallWidth" value="80" min="24" max="300" oninput="onWallDimensionChange()">
                            </div>
                            <div class="dimension-divider"></div>
                            <div class="dimension-input">
                                <span class="dimension-label">H</span>
                                <input type="number" id="wallHeight" value="80" min="24" max="200" oninput="onWallDimensionChange()">
                            </div>
                        </div>
                        <div class="unit-switcher" id="unitSwitcher" onclick="cycleWallUnits()">
                            <span id="wallUnitDisplay">IN</span>
                        </div>
                        <button class="refresh-wall-btn" id="refreshWallBtn" onclick="updateWall()" title="Update Wall">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M23 4V10H17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M1 20V14H7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M3.51 9.00001C4.01717 7.56679 4.87913 6.28542 6.01547 5.27543C7.1518 4.26545 8.52547 3.55977 10.0083 3.22427C11.4911 2.88877 13.0348 2.93436 14.4952 3.35679C15.9556 3.77922 17.2853 4.56473 18.36 5.64001L23 10M1 14L5.64 18.36C6.71475 19.4353 8.04437 20.2208 9.50481 20.6432C10.9652 21.0657 12.5089 21.1112 13.9917 20.7757C15.4745 20.4402 16.8482 19.7346 17.9845 18.7246C19.1209 17.7146 19.9828 16.4332 20.49 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                    <!-- Hidden elements for compatibility -->
                    <select id="wallUnits" style="display: none;">
                        <option value="inches">Inches</option>
                        <option value="cm">Centimeters</option>
                        <option value="mm">Millimeters</option>
                    </select>
                    <span id="wallWidthUnit" style="display: none;">inches</span>
                    <span id="wallHeightUnit" style="display: none;">inches</span>
                </div>
                <div class="form-group">
                    <label for="wallColor">Wall Color</label>
                    <input type="color" id="wallColor" value="#ffffff" class="color-input">
                </div>
                <div class="form-group">
                    <label for="wallImageUpload">Wall Background Image (optional)</label>
                    <input type="file" id="wallImageUpload" accept="image/*" onchange="handleWallImageUpload(event)">
                    <button onclick="removeWallImage()" style="margin-top: 5px; font-size: 12px; padding: 5px 10px;">Remove Image</button>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="showDistanceGuides" checked onchange="toggleDistanceGuides()"> Show Distance Guides
                    </label>
                </div>
            </div>
        </div>

        <div class="column-3">
            <div class="workspace">
                <button class="zoom-control-btn" onclick="toggleRoomView()" title="Toggle Room View">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M8 11h6M11 8v6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
                <div class="room-perspective-wrapper" id="roomPerspective">
                    <div class="room-container" id="roomContainer">
                        <div class="room-ceiling"></div>
                        <div class="room-left-wall"></div>
                        <div class="room-right-wall"></div>
                        <div class="room-floor"></div>
                        <div class="wall-container" id="wallContainer">
                            <svg id="distanceGuidesSVG" class="distance-guides-svg"></svg>
                            <input type="file" id="fileInput" accept="image/*" multiple onchange="handleImageUpload(event)" style="display: none;">
                            <button class="wall-icon upload-icon" onclick="document.getElementById('fileInput').click()" title="Upload Images">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 19V5M12 5L5 12M12 5L19 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                            <button class="wall-icon save-icon" onclick="saveLayout()" title="Save Layout">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H16L21 8V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M17 21V13H7V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M7 3V8H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                            <button class="wall-icon delete-icon" onclick="clearWall()" title="Clear Wall">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M3 6H5H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="layouts-panel" style="display: none;">
                <h3>Saved Layouts</h3>
                <div class="layout-grid" id="savedLayouts"></div>
            </div>
        </div>
    </div>

    <!-- Dialog for Selected Artwork Settings -->
    <div class="artwork-dialog" id="artworkDialog">
        <div class="dialog-content">
            <h4>Selected Artwork Settings</h4>
                <div class="control-row">
                    <div class="form-group">
                        <label for="artworkUnits">Artwork Units</label>
                        <select id="artworkUnits" onchange="updateArtworkUnits()">
                            <option value="inches">Inches</option>
                            <option value="cm">Centimeters</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="maintainRatio" checked onchange="updateArtworkSize()"> Lock Aspect Ratio
                        </label>
                    </div>
                </div>
                <div class="control-row">
                    <div class="form-group">
                        <label for="artworkWidth">Width (<span id="artworkWidthUnit">inches</span>)</label>
                        <input type="number" id="artworkWidth" step="0.1" min="1" onchange="updateArtworkSize()">
                    </div>
                    <div class="form-group">
                        <label for="artworkHeight">Height (<span id="artworkHeightUnit">inches</span>)</label>
                        <input type="number" id="artworkHeight" step="0.1" min="1" onchange="updateArtworkSize()">
                    </div>
                </div>
                <div class="control-row">
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="hasFrame" onchange="updateSelectedArtwork()"> Add Frame
                        </label>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="hasMatte" onchange="updateSelectedArtwork()"> Add Matte
                        </label>
                    </div>
                </div>
                <div class="control-row">
                    <div class="form-group">
                        <label for="frameColor">Frame Color</label>
                        <select id="frameColor" onchange="updateSelectedArtwork()">
                            <option value="#8b4513">Brown</option>
                            <option value="#000000">Black</option>
                            <option value="#ffffff">White</option>
                            <option value="#c0c0c0">Silver</option>
                            <option value="#ffd700">Gold</option>
                            <option value="#d2b48c">Birch</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="frameSize">Frame Width (<span id="frameUnit">inches</span>)</label>
                        <input type="number" id="frameSize" step="0.1" min="0.1" max="5" value="1" onchange="updateSelectedArtwork()">
                    </div>
                </div>
                <div class="control-row">
                    <div class="form-group">
                        <label for="matteColor">Matte Color</label>
                        <select id="matteColor" onchange="updateSelectedArtwork()">
                            <option value="#f5f5f5">Off-White</option>
                            <option value="#ffffff">White</option>
                            <option value="#f0f0f0">Light Gray</option>
                            <option value="#fffacd">Cream</option>
                            <option value="#000000">Black</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="matteSize">Matte Width (<span id="matteUnit">inches</span>)</label>
                        <input type="number" id="matteSize" step="0.1" min="0.1" max="5" value="1" onchange="updateSelectedArtwork()">
                    </div>
                </div>
                <button onclick="deleteSelected()">üóëÔ∏è Remove Artwork</button>
        </div>
    </div>

    <!-- Phase 1: Foundation modules -->
    <script src="js/utils.js"></script>
    <script src="js/state.js"></script>
    <!-- Phase 2: Wall module -->
    <script src="js/wall.js"></script>
    <!-- Phase 3: Artwork modules -->
    <script src="js/framing.js"></script>
    <script src="js/artwork.js"></script>
    <!-- Phase 4: Visual features -->
    <script src="js/distance-guides.js"></script>
    <script src="js/room-view.js"></script>
    <!-- Phase 5: Storage -->
    <script src="js/storage.js"></script>
    <!-- Phase 6: UI and initialization -->
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
